package shlm.lmcs.com.lazycat.LazyShopMonitor;import android.content.Context;import android.util.Log;import android.view.View;import android.widget.ImageView;import android.widget.LinearLayout;import android.widget.TextView;import org.xmlpull.v1.XmlPullParser;import java.util.ArrayList;import java.util.List;import shlm.lmcs.com.lazycat.LazyCatProgramUnt.Config;import shlm.lmcs.com.lazycat.LazyCatProgramUnt.Factory.XmlTagValuesFactory;import shlm.lmcs.com.lazycat.LazyCatProgramUnt.Factory.XmlanalysisFactory;import shlm.lmcs.com.lazycat.LazyCatProgramUnt.Net;import shlm.lmcs.com.lazycat.LazyShopValues.LocalMerchantXmlvalues;import shlm.lmcs.com.lazycat.R;/** * 商家促销的管理者 * <p> * 在首页中管理商家促销的界面 */public class MerchantMonitor extends Monitor {    private Context mContext;    private LinearLayout _merchantView;    private MonitorViewIDPage.MerchantMonitorViewidPage viewidPage = new MonitorViewIDPage            .MerchantMonitorViewidPage();    private XmlTagValuesFactory.XMLtagMainMerchant xmLtagMainMerchant = new XmlTagValuesFactory            .XMLtagMainMerchant();    private LocalMerchantXmlvalues MerchantXmlvalues = null;    private List<LocalMerchantXmlvalues> MerchantXmlList = new ArrayList<LocalMerchantXmlvalues>();    public MerchantMonitor(View merchantView, Context context) {        this.mContext = context;        this._merchantView = (LinearLayout) merchantView;        /*初始化处理 处理商家促销的界面控件ID整理*/        /*第一个背景图片*/        viewidPage.setMERCHANTMONITOR_FIRSTBACKGROUND((ImageView) this._merchantView.findViewById                (R.id.assembly_fragment_main_erpromotion_firstBackground));        /*第一个状态*/        viewidPage.setMERCHANTMONITOR_FIRSTSTATUS((TextView) this._merchantView.findViewById(R.id                .assembly_fragment_main_erpromotion_firstStatus));        /*第一个标题*/        viewidPage.setMERCHANTMONITOR_FIRSTTITLE((TextView) this._merchantView.findViewById(R.id                .assembly_fragment_main_erpromotion_fristTitle));        /*第一个标语*/        viewidPage.setMERCHANTMONITOR_FIRSTTEXT((TextView) this._merchantView.findViewById(R.id                .assembly_fragment_main_erpromotion_fristText));        /**         * 第二个图片控件         */        /*第一个背景图片*/        viewidPage.setMERCHANTMONITOR_FIRSTBACKGROUND((ImageView) this._merchantView.findViewById                (R.id.assembly_fragment_main_erpromotion_secondBackground));        /*第一个状态*/        viewidPage.setMERCHANTMONITOR_FIRSTSTATUS((TextView) this._merchantView.findViewById(R.id                .assembly_fragment_main_erpromotion_secondStatus));        /*第一个标题*/        viewidPage.setMERCHANTMONITOR_FIRSTTITLE((TextView) this._merchantView.findViewById(R.id                .assembly_fragment_main_erpromotion_secondTitle));        /*第一个标语*/        viewidPage.setMERCHANTMONITOR_FIRSTTEXT((TextView) this._merchantView.findViewById(R.id                .assembly_fragment_main_erpromotion_secondText));        /**         * 第三个图片控件         */        /*第一个背景图片*/        viewidPage.setMERCHANTMONITOR_FIRSTBACKGROUND((ImageView) this._merchantView.findViewById                (R.id.assembly_fragment_main_erpromotion_threeBackground));        /*第一个状态*/        viewidPage.setMERCHANTMONITOR_FIRSTSTATUS((TextView) this._merchantView.findViewById(R.id                .assembly_fragment_main_erpromotion_threeStatus));        /*第一个标题*/        viewidPage.setMERCHANTMONITOR_FIRSTTITLE((TextView) this._merchantView.findViewById(R.id                .assembly_fragment_main_erpromotion_threeTitle));        /*第一个标语*/        viewidPage.setMERCHANTMONITOR_FIRSTTEXT((TextView) this._merchantView.findViewById(R.id                .assembly_fragment_main_erpromotion_threeText));        /**         * 第四个图片控件         */        /*第一个背景图片*/        viewidPage.setMERCHANTMONITOR_FIRSTBACKGROUND((ImageView) this._merchantView.findViewById                (R.id.assembly_fragment_main_erpromotion_fourBackground));        /*第一个状态*/        viewidPage.setMERCHANTMONITOR_FIRSTSTATUS((TextView) this._merchantView.findViewById(R.id                .assembly_fragment_main_erpromotion_fourStatus));        /*第一个标题*/        viewidPage.setMERCHANTMONITOR_FIRSTTITLE((TextView) this._merchantView.findViewById(R.id                .assembly_fragment_main_erpromotion_fourTitle));        /*第一个标语*/        viewidPage.setMERCHANTMONITOR_FIRSTTEXT((TextView) this._merchantView.findViewById(R.id                .assembly_fragment_main_erpromotion_fourText));    }    /**     * 开始事务管理     */    public void Start() {        /*访问互联网获取数据信息*/        Net.doGet(mContext, Config.HTTP_ADDR.getMerchantMonitorAddr(), new Net                .onVisitInterServiceListener() {            @Override            public void onSucess(String tOrgin) {                Log.i(Config.DEBUG, "MerchantMonitor.java[+]获取到的MerchantMonitor数据为:" + tOrgin                        .toString());                onXml(tOrgin);            }            @Override            public void onNotConnect() {            }            @Override            public void onFail(String tOrgin) {            }        });    }    private void onXml(String xml) {        MerchantXmlvalues = null;        XmlanalysisFactory xmlanalysisFactory = new XmlanalysisFactory(xml);        xmlanalysisFactory.Startanalysis(new XmlanalysisFactory.XmlanalysisInterface() {            @Override            public void onFaile() {            }            @Override            public void onStartDocument() {            }            @Override            public void onStartTag(String tag, XmlPullParser pullParser, Integer id) {                try {                    if (tag.equals(XmlTagValuesFactory.XMLtagMainMerchant.key_merchant_title)) {                        xmLtagMainMerchant.setMerchant_title(pullParser.nextText());                    }                    if (tag.equals(XmlTagValuesFactory.XMLtagMainMerchant.key_merchant_photoaddr)) {                        xmLtagMainMerchant.setMerchant_photoaddr(pullParser.nextText());                    }                    if (tag.equals(XmlTagValuesFactory.XMLtagMainMerchant.key_merchant_values)) {                        /*创建一个类*/                        if (MerchantXmlvalues == null) {                            MerchantXmlvalues = new LocalMerchantXmlvalues();                        }                    }                    if (tag.equals(XmlTagValuesFactory.XMLtagMainMerchant                            .key_merchant_values_title)) {                        /*标题*/                        MerchantXmlvalues.setTitle(pullParser.nextText());                    }                    if (tag.equals(XmlTagValuesFactory.XMLtagMainMerchant                            .key_merchant_values_text)) {                        MerchantXmlvalues.setText(pullParser.nextText());                    }                    if (tag.equals(XmlTagValuesFactory.XMLtagMainMerchant                            .key_merchant_values_status)) {                        MerchantXmlvalues.setStatus(pullParser.nextText());                    }                    if (tag.equals(XmlTagValuesFactory.XMLtagMainMerchant                            .key_merchant_values_background)) {                        MerchantXmlvalues.setBackground(pullParser.nextText());                    }                } catch (Exception e) {                }            }            @Override            public void onEndTag(String tag, XmlPullParser pullParser, Integer id) {                Log.e(Config.DEBUG, "MerchantMonitor.java[+]结束节点为:" + tag);                if (tag.equals(XmlTagValuesFactory.XMLtagMainMerchant.key_merchant_values)) {                    MerchantXmlList.add(MerchantXmlvalues);                    MerchantXmlvalues = null;                }            }            @Override            public void onEndDocument() {                LinearLayout layout = (LinearLayout) _merchantView.getChildAt(0);/*获取第一个就是控件*/                /*整理界面 除了背景之外.因为背景需要下载*/                TextView first_title = layout.findViewById(R.id                        .assembly_fragment_main_erpromotion_fristTitle);                TextView second_title = layout.findViewById(R.id                        .assembly_fragment_main_erpromotion_secondTitle);                TextView three_title = layout.findViewById(R.id                        .assembly_fragment_main_erpromotion_threeTitle);                TextView four_title = layout.findViewById(R.id                        .assembly_fragment_main_erpromotion_fourTitle);                /*标语View*/                TextView first_text = layout.findViewById(R.id                        .assembly_fragment_main_erpromotion_fristText);                TextView second_text = layout.findViewById(R.id                        .assembly_fragment_main_erpromotion_secondText);                TextView three_text = layout.findViewById(R.id                        .assembly_fragment_main_erpromotion_threeText);                TextView four_text = layout.findViewById(R.id                        .assembly_fragment_main_erpromotion_fourText);                /*状态的View*/                TextView first_status = layout.findViewById(R.id                        .assembly_fragment_main_erpromotion_firstStatus);                TextView second_status = layout.findViewById(R.id                        .assembly_fragment_main_erpromotion_secondStatus);                TextView three_status = layout.findViewById(R.id                        .assembly_fragment_main_erpromotion_threeStatus);                TextView four_status = layout.findViewById(R.id                        .assembly_fragment_main_erpromotion_fourStatus);                /*整理标题*/                first_title.setText(MerchantXmlList.get(0).getTitle());                second_title.setText(MerchantXmlList.get(1).getTitle());                three_title.setText(MerchantXmlList.get(2).getTitle());                four_title.setText(MerchantXmlList.get(3).getTitle());                /*整理标语*/                first_text.setText(MerchantXmlList.get(0).getText());                second_text.setText(MerchantXmlList.get(1).getText());                three_text.setText(MerchantXmlList.get(2).getText());                four_text.setText(MerchantXmlList.get(3).getText());                /*整理状态*/                first_status.setText(MerchantXmlList.get(0).getStatus());                second_status.setText(MerchantXmlList.get(1).getStatus());                three_status.setText(MerchantXmlList.get(2).getStatus());                four_status.setText(MerchantXmlList.get(3).getStatus());            }        });    }}