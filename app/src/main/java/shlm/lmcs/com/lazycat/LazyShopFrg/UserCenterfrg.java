package shlm.lmcs.com.lazycat.LazyShopFrg;import android.annotation.SuppressLint;import android.os.Bundle;import android.util.Log;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.widget.LinearLayout;import android.widget.TextView;import org.xmlpull.v1.XmlPullParser;import java.util.ArrayList;import shlm.lmcs.com.lazycat.LazyCatProgramUnt.CompanyClass.LazyCatFragment;import shlm.lmcs.com.lazycat.LazyCatProgramUnt.CompanyPage.WAIT_ITME_DIALOGPAGE;import shlm.lmcs.com.lazycat.LazyCatProgramUnt.CompanyTools.TextUnt;import shlm.lmcs.com.lazycat.LazyCatProgramUnt.Config;import shlm.lmcs.com.lazycat.LazyCatProgramUnt.Factory.WaitDialog;import shlm.lmcs.com.lazycat.LazyCatProgramUnt.Factory.XmlTagValuesFactory;import shlm.lmcs.com.lazycat.LazyCatProgramUnt.Factory.XmlanalysisFactory;import shlm.lmcs.com.lazycat.LazyCatProgramUnt.Net;import shlm.lmcs.com.lazycat.LazyCatProgramUnt.Tools;import shlm.lmcs.com.lazycat.LazyShopValues.LocalValues;import shlm.lmcs.com.lazycat.R;public class UserCenterfrg extends LazyCatFragment {    private String MSG = "UserCenterfrg.java[+]";    private LinearLayout CardBody;    private XmlTagValuesFactory.XMLValuesUserpageCard userpageCard = null;    private XmlTagValuesFactory.XMLValuesUserpageBtnItem item = null;/*控件BTN*/    private XmlTagValuesFactory.Init_UserCenterValues init_userCenter = null;    private ArrayList<XmlTagValuesFactory.XMLValuesUserpageCard> cardList = new            ArrayList<XmlTagValuesFactory.XMLValuesUserpageCard>();    private TextView business_balance;    private TextView business_name;    private TextView business_vip;    private TextView business_coupon;    private TextView business_integral;    private TextView business_rechargerecord;    private TextView btn_addVip;    private TextView btn_recharge;    @SuppressLint({"NewApi", "ResourceType"})    @Override    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle            savedInstanceState) {        View item = inflater.inflate(R.layout.fragment_user, null);        /*获取主题的颜色  */        setStatusBar(getResources().getString(R.color.ThemeColor));        /*我的功能body*///        LinearLayout mefuctionBody = item.findViewById(R.id.usercenterfrg_mefuctionBody);        item.findViewById(R.id.usercenterfrg_userValuesBody).setBackground(Tools.CreateDrawable                (1, "#ffffff", "#ffffff", 15));        CardBody = item.findViewById(R.id.usercenterfrg_cardBody);/*添加card的body*/        /*这个显示余额*/        business_balance = item.findViewById(R.id.fragmen_user_balance);        /*这个现实商户的名称*/        business_name = item.findViewById(R.id.fragmen_user_business_name);        /*这个现实VIP*/        business_vip = item.findViewById(R.id.fragment_user_vip);        /*这个是显示优惠卷*/        business_coupon = item.findViewById(R.id.fragmen_user_coupon);        /*这个显示积分*/        business_integral = item.findViewById(R.id.fragmen_user_integral);        /*这个显示交易的次数*/        business_rechargerecord = item.findViewById(R.id.fragmen_user_rechargerecord);        /*加入VIP的选项*/        btn_addVip = item.findViewById(R.id.fragmen_user_btnAddVip);        /*充值按钮*/        btn_recharge = item.findViewById(R.id.fragmen_user_btnRecharge);        /*初始化充值按钮的样式*/        TextUnt.with(btn_recharge).setBackground(Tools.CreateDrawable(1, "#00a1d6", "#00a1d6", 5));        /**         /*初始化Card*/        /* *//*4个导航*//*        for (int i = 0; i < 4; i++) {            RelativeLayout rl = new RelativeLayout(getContext());*//*创建布局*//*            rl.setBackground(Tools.CreateDrawable(1, "#e9e9e9", "#e9e9e9", 5));            *//*设置权重*//*            LinearLayout.LayoutParams params = new LinearLayout.LayoutParams(0, LinearLayout                    .LayoutParams.WRAP_CONTENT, 1.0f);            params.setMargins(10, 10, 10, 10);            *//*设置图片*//*            RelativeLayout.LayoutParams ivParams = new RelativeLayout.LayoutParams(100, 100);            ImageView iv = new ImageView(getContext());            ivParams.addRule(RelativeLayout.CENTER_HORIZONTAL);            ivParams.setMargins(0, 50, 0, 0);            iv.setLayoutParams(ivParams);            iv.setImageResource(R.drawable.ico_bell);            rl.addView(iv);            *//*加入图片布局*//*            rl.setLayoutParams(params);            *//*设置文字*//*            RelativeLayout.LayoutParams tvParams = new RelativeLayout.LayoutParams(RelativeLayout                    .LayoutParams.MATCH_PARENT, RelativeLayout.LayoutParams.WRAP_CONTENT);            TextView title = new TextView(getContext());            title.setText("这是第" + i);            title.setTextColor(Color.parseColor("#ffffff"));            title.setTextSize(12);            tvParams.setMargins(0, 160, 0, 0);            title.setLayoutParams(tvParams);            title.setGravity(Gravity.CENTER);            rl.addView(title);            mefuctionBody.addView(rl);        }*//*        item.findViewById(R.id.usercenterfrg_mefuction).setBackground(Tools.CreateDrawable(1,                "#e9e9e9", "#ffffff", 5));*/        ;        setTransparentBar();        init(item);        return item;    }    @SuppressLint("NewApi")    private void init(View item) {        /*访问服务器 获取初始化配置文件*/        Net.doGet(getContext(), Config.HTTP_ADDR.CONFIG_GET_USERVALUES_SERVICE, new Net                .onVisitInterServiceListener() {            @Override            public WaitDialog.RefreshDialog onStartLoad() {                /*初始化一个DIALOG*/                final WaitDialog.RefreshDialog refreshDialog = new WaitDialog.RefreshDialog                        (getActivity());                WAIT_ITME_DIALOGPAGE wait_itme_dialogpage = new WAIT_ITME_DIALOGPAGE();                wait_itme_dialogpage.setImg(R.id.item_wait_img);                wait_itme_dialogpage.setView(R.layout.item_wait);                wait_itme_dialogpage.setTitle(R.id.item_wait_title);                refreshDialog.Init(wait_itme_dialogpage);                refreshDialog.showRefreshDialog("加载中...", false);                return refreshDialog;            }            @Override            public void onSucess(String tOrgin, WaitDialog.RefreshDialog _RefreshDialog) {                _RefreshDialog.dismiss();                Log.i(MSG, "返回数据:" + tOrgin);                Log.i(MSG, "" + XmlTagValuesFactory.Init_UserCenter.ACTION_NAME);                handlXml(tOrgin.trim());            }            @Override            public void onNotConnect() {            }            @Override            public void onFail(String tOrgin) {            }        });    }    /*处理xml数据信息*/    private void handlXml(String tOrgin) {        XmlanalysisFactory xml = new XmlanalysisFactory(tOrgin);        xml.Startanalysis(new XmlanalysisFactory.XmlanalysisInterface() {            @Override            public void onFaile() {            }            @Override            public void onStartDocument(String tag) {                init_userCenter = XmlTagValuesFactory.getXmlServiceInitCenterInstance();            }            @Override            public void onStartTag(String tag, XmlPullParser pullParser, Integer id) {                try {                    /*名称*/                    if (tag.equals(XmlTagValuesFactory.Init_UserCenter.ACTION_NAME)) {                        if (init_userCenter != null) {                        } else {                            Log.e(MSG, "错误,没有初始化Init_userCenter");                        }                        init_userCenter.setName(pullParser.nextText().trim());                    }                    /*余额*/                    if (tag.equals(XmlTagValuesFactory.Init_UserCenter.ACTION_BALANCE)) {                        init_userCenter.setBalance(pullParser.nextText().trim());                    }                    /*优惠卷*/                    if (tag.equals(XmlTagValuesFactory.Init_UserCenter.ACTION_COUPON)) {                        init_userCenter.setCoupon(pullParser.nextText().trim());                    }                    /*图片*/                    if (tag.equals(XmlTagValuesFactory.Init_UserCenter.ACTION_IMG)) {                        init_userCenter.setImg(pullParser.nextText().trim());                    }                    /*积分*/                    if (tag.equals(XmlTagValuesFactory.Init_UserCenter.ACTION_INTEGRAL)) {                        init_userCenter.setIntegral(pullParser.nextText().trim());                    }                    /*是否VIP*/                    if (tag.equals(XmlTagValuesFactory.Init_UserCenter.ACTION_VIP)) {                        init_userCenter.setVip(pullParser.nextText().trim());                    }                    /*交易记录*/                    if (tag.equals(XmlTagValuesFactory.Init_UserCenter.ACTION_RECHARGERECORD)) {                        init_userCenter.setRechargerecord(pullParser.nextText());                    }                } catch (Exception e) {                }            }            @Override            public void onEndTag(String tag, XmlPullParser pullParser, Integer id) {            }            @SuppressLint({"NewApi", "ResourceType"})            @Override            public void onEndDocument() {                /**                 * 处理界面                 */                Log.i(MSG, "商户名称:" + init_userCenter.getName());                TextUnt.with(business_name).setText(init_userCenter.getName());                TextUnt.with(business_balance).setText(init_userCenter.getBalance());                Log.i(MSG, "余额:" + init_userCenter.getBalance());                TextUnt.with(business_coupon).setText(init_userCenter.getCoupon());                Log.i(MSG, "优惠卷:" + init_userCenter.getCoupon());                TextUnt.with(business_integral).setText(init_userCenter.getIntegral());                Log.i(MSG, "积分:" + init_userCenter.getIntegral());                TextUnt.with(business_rechargerecord).setText(init_userCenter.getRechargerecord());                Log.i(MSG, "交易记录:" + init_userCenter.getRechargerecord());                if (init_userCenter.getVip().equals(LocalValues.VALUES_USERCENTER.IS_NOT_VIP)) {                    /*不是VIP*/                    TextUnt.with(business_vip).setText("VIP").setBackground(Tools.CreateDrawable                            (1, "#666666", "#666666", 50)).setTextColor("#ffffff");                    /*显示加入vip*/                    TextUnt.with(btn_addVip).setText("加入VIP").setBackground(Tools.CreateDrawable                            (1, getResources().getString(R.color.colorVip), getResources()                                    .getString(R.color.colorVip), 50)).setTextColor("#ffffff");                } else {                    TextUnt.with(business_vip).setText("VIP").setTextColor(getResources()                            .getString(R.color.colorVip));                    TextUnt.with(business_vip).setText("VIP").setBackground(Tools.CreateDrawable                            (1, getResources().getString(R.color.colorVip), getResources()                                    .getString(R.color.colorVip), 50)).setTextColor("#ffffff");                    /*显示VIP特权*/                    TextUnt.with(btn_addVip).setText("VIP特权").setBackground(Tools.CreateDrawable                            (1, getResources().getString(R.color.colorVip), getResources()                                    .getString(R.color.colorVip), 50)).setTextColor("#ffffff");                }            }        });    }}